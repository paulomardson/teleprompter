<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teleprompter</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-black text-white overflow-hidden">
    <div id="app" class="h-screen flex flex-col">
        <!-- Controles -->
        <div id="controls" class="bg-zinc-950 border-b border-zinc-800 p-3 sm:p-4">
            <div class="max-w-7xl mx-auto space-y-3">
                <!-- Linha 1: Bot√µes principais e idioma -->
                <div class="flex items-center justify-between gap-2 sm:gap-4 flex-wrap">
                    <div class="flex gap-1 sm:gap-2 flex-wrap">
                        <button onclick="togglePlay()" id="playBtn" class="group relative bg-zinc-900 hover:bg-zinc-800 border border-zinc-700 hover:border-zinc-600 px-3 sm:px-5 py-2 sm:py-2.5 rounded-lg text-xs sm:text-sm font-medium transition-all duration-200 shadow-lg hover:shadow-xl">
                            <span class="flex items-center gap-1 sm:gap-2">
                                <span id="playIcon">‚ñ∂</span>
                                <span id="playText" data-key="play" class="hidden sm:inline">Play</span>
                            </span>
                        </button>
                        <button onclick="resetScroll()" class="bg-zinc-900 hover:bg-zinc-800 border border-zinc-700 hover:border-zinc-600 px-3 sm:px-5 py-2 sm:py-2.5 rounded-lg text-xs sm:text-sm font-medium transition-all duration-200 shadow-lg hover:shadow-xl">
                            <span class="flex items-center gap-1 sm:gap-2">
                                <span>‚Üª</span>
                                <span data-key="reset" class="hidden sm:inline">Reset</span>
                            </span>
                        </button>
                        <button onclick="toggleEdit()" class="bg-zinc-900 hover:bg-zinc-800 border border-zinc-700 hover:border-zinc-600 px-3 sm:px-5 py-2 sm:py-2.5 rounded-lg text-xs sm:text-sm font-medium transition-all duration-200 shadow-lg hover:shadow-xl">
                            <span class="flex items-center gap-1 sm:gap-2">
                                <span>‚úé</span>
                                <span data-key="edit" class="hidden sm:inline">Editar</span>
                            </span>
                        </button>
                        <button onclick="toggleMirror()" id="mirrorBtn" class="bg-zinc-900 hover:bg-zinc-800 border border-zinc-700 hover:border-zinc-600 px-3 sm:px-5 py-2 sm:py-2.5 rounded-lg text-xs sm:text-sm font-medium transition-all duration-200 shadow-lg hover:shadow-xl">
                            <span class="flex items-center gap-1 sm:gap-2">
                                <span>‚áÑ</span>
                                <span data-key="mirror" class="hidden sm:inline">Espelhar</span>
                            </span>
                        </button>
                        <button onclick="toggleFullscreen()" id="fullscreenBtn" class="bg-zinc-900 hover:bg-zinc-800 border border-zinc-700 hover:border-zinc-600 px-3 sm:px-5 py-2 sm:py-2.5 rounded-lg text-xs sm:text-sm font-medium transition-all duration-200 shadow-lg hover:shadow-xl">
                            <span class="flex items-center gap-1 sm:gap-2">
                                <span>‚õ∂</span>
                                <span data-key="fullscreen" class="hidden sm:inline">Fullscreen</span>
                            </span>
                        </button>
                    </div>

                    <!-- Seletor de Idioma -->
                    <div class="flex items-center gap-2">
                        <label class="text-xs sm:text-sm text-zinc-400 hidden sm:inline" data-key="language">Idioma:</label>
                        <select id="langSelect" onchange="changeLanguage(this.value)" class="bg-zinc-900 border border-zinc-700 hover:border-zinc-600 text-white px-2 sm:px-4 py-2 rounded-lg text-xs sm:text-sm focus:outline-none focus:border-zinc-500 transition-all cursor-pointer">
                            <option value="pt">üáßüá∑ PT</option>
                            <option value="en">üá∫üá∏ EN</option>
                            <option value="de">üá©üá™ DE</option>
                            <option value="es">üá™üá∏ ES</option>
                            <option value="zh">üá®üá≥ ‰∏≠Êñá</option>
                        </select>
                    </div>
                </div>

                <!-- Linha 2: Controles deslizantes -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="bg-zinc-900 border border-zinc-800 rounded-lg p-3">
                        <div class="flex items-center justify-between mb-2">
                            <label class="text-sm text-zinc-300" data-key="speed">Velocidade</label>
                            <span id="speedValue" class="text-sm text-white font-medium bg-zinc-800 px-2 py-1 rounded">1.5</span>
                        </div>
                        <input type="range" id="speed" min="0.5" max="8" step="0.5" value="1.5" 
                               oninput="updateSpeed(this.value)" 
                               class="w-full h-2 bg-zinc-800 rounded-lg appearance-none cursor-pointer accent-zinc-400">
                    </div>
                    <div class="bg-zinc-900 border border-zinc-800 rounded-lg p-3">
                        <div class="flex items-center justify-between mb-2">
                            <label class="text-sm text-zinc-300" data-key="fontSize">Tamanho do Texto</label>
                            <span id="sizeValue" class="text-sm text-white font-medium bg-zinc-800 px-2 py-1 rounded">56px</span>
                        </div>
                        <input type="range" id="fontSizeInput" min="32" max="96" step="4" value="56" 
                               oninput="updateFontSize(this.value)" 
                               class="w-full h-2 bg-zinc-800 rounded-lg appearance-none cursor-pointer accent-zinc-400">
                    </div>
                </div>

                <!-- Bot√£o Ocultar -->
                <div class="flex justify-end">
                    <button onclick="toggleControls()" class="bg-zinc-900 hover:bg-zinc-800 border border-zinc-700 hover:border-zinc-600 px-4 py-2 rounded-lg text-xs text-zinc-400 hover:text-zinc-200 transition-all duration-200">
                        <span data-key="hide">Ocultar Controles</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Bot√£o para mostrar controles (aparece quando ocultos) -->
        <button id="showControlsBtn" onclick="toggleControls()" class="hidden fixed top-4 right-4 bg-zinc-900 bg-opacity-90 hover:bg-opacity-100 border border-zinc-700 px-4 py-2 rounded-lg text-sm transition-all z-40 shadow-2xl backdrop-blur-sm">
            <span data-key="show">Mostrar Controles</span>
        </button>

        <!-- √Årea do Teleprompter -->
        <div id="prompter" class="flex-1 overflow-y-auto overflow-x-hidden">
            <div id="textContainer" class="min-h-full flex items-start justify-center pt-[50vh] pb-[50vh]">
                <div id="scrollText" class="text-center leading-relaxed max-w-5xl px-8 w-full">
                    <p class="mb-12" data-key="welcome">Bem-vindo ao Teleprompter</p>
                    <p class="mb-12" data-key="clickEdit">Clique em "Editar" para adicionar seu texto</p>
                    <p class="mb-12" data-key="spaceKey">Use ESPA√áO para pausar/continuar</p>
                    <p class="mb-12" data-key="arrowKeys">Setas ‚Üë ‚Üì ajustam a velocidade</p>
                    <p class="mb-12" data-key="enjoy">Boa apresenta√ß√£o!</p>
                </div>
            </div>
        </div>

        <!-- Modal de Edi√ß√£o -->
        <div id="editModal" class="hidden fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50 p-4">
            <div class="bg-zinc-900 border border-zinc-800 rounded-xl max-w-4xl w-full max-h-[90vh] flex flex-col shadow-2xl">
                <div class="p-5 border-b border-zinc-800">
                    <h2 class="text-xl font-light" data-key="editText">Editar Texto</h2>
                </div>
                <div class="p-5 flex-1 overflow-auto">
                    <textarea id="textEditor" class="w-full h-96 bg-black text-white p-4 rounded-lg border border-zinc-800 focus:border-zinc-600 focus:outline-none text-base font-mono resize-none" 
                              data-key-placeholder="editPlaceholder"></textarea>
                </div>
                <div class="p-5 border-t border-zinc-800 flex gap-3 justify-end">
                    <button onclick="cancelEdit()" class="bg-zinc-800 hover:bg-zinc-700 border border-zinc-700 hover:border-zinc-600 px-6 py-2.5 rounded-lg text-sm font-medium transition-all">
                        <span data-key="cancel">Cancelar</span>
                    </button>
                    <button onclick="saveText()" class="bg-white text-black hover:bg-zinc-200 px-6 py-2.5 rounded-lg text-sm font-medium transition-all shadow-lg">
                        <span data-key="save">Salvar</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Tradu√ß√µes
        const translations = {
            pt: {
                play: 'Play',
                pause: 'Pause',
                reset: 'Reset',
                edit: 'Editar',
                mirror: 'Espelhar',
                fullscreen: 'Fullscreen',
                exitFullscreen: 'Sair Fullscreen',
                language: 'Idioma:',
                speed: 'Velocidade',
                fontSize: 'Tamanho do Texto',
                hide: 'Ocultar Controles',
                show: 'Mostrar Controles',
                welcome: 'Bem-vindo ao Teleprompter',
                clickEdit: 'Clique em "Editar" para adicionar seu texto',
                spaceKey: 'Use ESPA√áO para pausar/continuar',
                arrowKeys: 'Setas ‚Üë ‚Üì ajustam a velocidade',
                enjoy: 'Boa apresenta√ß√£o!',
                editText: 'Editar Texto',
                editPlaceholder: 'Digite seu texto aqui...\n\nSepare par√°grafos com linhas em branco',
                cancel: 'Cancelar',
                save: 'Salvar'
            },
            en: {
                play: 'Play',
                pause: 'Pause',
                reset: 'Reset',
                edit: 'Edit',
                mirror: 'Mirror',
                fullscreen: 'Fullscreen',
                exitFullscreen: 'Exit Fullscreen',
                language: 'Language:',
                speed: 'Speed',
                fontSize: 'Text Size',
                hide: 'Hide Controls',
                show: 'Show Controls',
                welcome: 'Welcome to Teleprompter',
                clickEdit: 'Click "Edit" to add your text',
                spaceKey: 'Press SPACE to pause/continue',
                arrowKeys: 'Arrows ‚Üë ‚Üì adjust speed',
                enjoy: 'Enjoy your presentation!',
                editText: 'Edit Text',
                editPlaceholder: 'Type your text here...\n\nSeparate paragraphs with blank lines',
                cancel: 'Cancel',
                save: 'Save'
            },
            de: {
                play: 'Abspielen',
                pause: 'Pause',
                reset: 'Zur√ºcksetzen',
                edit: 'Bearbeiten',
                mirror: 'Spiegeln',
                fullscreen: 'Vollbild',
                exitFullscreen: 'Vollbild beenden',
                language: 'Sprache:',
                speed: 'Geschwindigkeit',
                fontSize: 'Textgr√∂√üe',
                hide: 'Steuerung ausblenden',
                show: 'Steuerung anzeigen',
                welcome: 'Willkommen beim Teleprompter',
                clickEdit: 'Klicken Sie auf "Bearbeiten", um Ihren Text hinzuzuf√ºgen',
                spaceKey: 'Dr√ºcken Sie LEERTASTE zum Pausieren/Fortsetzen',
                arrowKeys: 'Pfeile ‚Üë ‚Üì passen die Geschwindigkeit an',
                enjoy: 'Viel Erfolg bei Ihrer Pr√§sentation!',
                editText: 'Text bearbeiten',
                editPlaceholder: 'Geben Sie hier Ihren Text ein...\n\nTrennen Sie Abs√§tze mit Leerzeilen',
                cancel: 'Abbrechen',
                save: 'Speichern'
            },
            es: {
                play: 'Reproducir',
                pause: 'Pausa',
                reset: 'Reiniciar',
                edit: 'Editar',
                mirror: 'Reflejar',
                fullscreen: 'Pantalla completa',
                exitFullscreen: 'Salir pantalla completa',
                language: 'Idioma:',
                speed: 'Velocidad',
                fontSize: 'Tama√±o del texto',
                hide: 'Ocultar controles',
                show: 'Mostrar controles',
                welcome: 'Bienvenido al Teleprompter',
                clickEdit: 'Haga clic en "Editar" para agregar su texto',
                spaceKey: 'Presione ESPACIO para pausar/continuar',
                arrowKeys: 'Flechas ‚Üë ‚Üì ajustan la velocidad',
                enjoy: '¬°Buena presentaci√≥n!',
                editText: 'Editar texto',
                editPlaceholder: 'Escriba su texto aqu√≠...\n\nSepare p√°rrafos con l√≠neas en blanco',
                cancel: 'Cancelar',
                save: 'Guardar'
            },
            zh: {
                play: 'Êí≠Êîæ',
                pause: 'ÊöÇÂÅú',
                reset: 'ÈáçÁΩÆ',
                edit: 'ÁºñËæë',
                mirror: 'ÈïúÂÉè',
                fullscreen: 'ÂÖ®Â±è',
                exitFullscreen: 'ÈÄÄÂá∫ÂÖ®Â±è',
                language: 'ËØ≠Ë®ÄÔºö',
                speed: 'ÈÄüÂ∫¶',
                fontSize: 'ÊñáÂ≠óÂ§ßÂ∞è',
                hide: 'ÈöêËóèÊéß‰ª∂',
                show: 'ÊòæÁ§∫Êéß‰ª∂',
                welcome: 'Ê¨¢Ëøé‰ΩøÁî®ÊèêËØçÂô®',
                clickEdit: 'ÁÇπÂáª"ÁºñËæë"Ê∑ªÂä†ÊÇ®ÁöÑÊñáÊú¨',
                spaceKey: 'ÊåâÁ©∫Ê†ºÈîÆÊöÇÂÅú/ÁªßÁª≠',
                arrowKeys: 'ÁÆ≠Â§¥ ‚Üë ‚Üì Ë∞ÉÊï¥ÈÄüÂ∫¶',
                enjoy: 'Á•ùÊÇ®ÊºîÁ§∫È°∫Âà©ÔºÅ',
                editText: 'ÁºñËæëÊñáÊú¨',
                editPlaceholder: 'Âú®Ê≠§ËæìÂÖ•ÊÇ®ÁöÑÊñáÊú¨...\n\nÁî®Á©∫Ë°åÂàÜÈöîÊÆµËêΩ',
                cancel: 'ÂèñÊ∂à',
                save: '‰øùÂ≠ò'
            }
        };

        let currentLang = 'pt';
        let isPlaying = false;
        let scrollSpeed = 1.5;
        let fontSize = 56;
        let isMirrored = false;
        let lastTimestamp = 0;
        let wakeLock = null;

        const scrollText = document.getElementById('scrollText');
        const prompter = document.getElementById('prompter');
        const playBtn = document.getElementById('playBtn');
        const editModal = document.getElementById('editModal');
        const textEditor = document.getElementById('textEditor');
        const controls = document.getElementById('controls');
        const showControlsBtn = document.getElementById('showControlsBtn');

        scrollText.style.fontSize = fontSize + 'px';

        function changeLanguage(lang) {
            currentLang = lang;
            document.querySelectorAll('[data-key]').forEach(el => {
                const key = el.getAttribute('data-key');
                if (translations[lang][key]) {
                    el.textContent = translations[lang][key];
                }
            });
            
            const placeholder = document.querySelector('[data-key-placeholder]');
            if (placeholder) {
                placeholder.placeholder = translations[lang].editPlaceholder;
            }
            
            if (!isPlaying) {
                document.getElementById('playText').textContent = translations[lang].play;
            } else {
                document.getElementById('playText').textContent = translations[lang].pause;
            }
        }

        async function requestWakeLock() {
            try {
                if ('wakeLock' in navigator) {
                    wakeLock = await navigator.wakeLock.request('screen');
                    wakeLock.addEventListener('release', () => {
                        console.log('Wake Lock liberado');
                    });
                }
            } catch (err) {
                console.log('Erro ao ativar Wake Lock:', err);
            }
        }

        async function releaseWakeLock() {
            if (wakeLock !== null) {
                await wakeLock.release();
                wakeLock = null;
            }
        }

        document.addEventListener('visibilitychange', async () => {
            if (wakeLock !== null && document.visibilityState === 'visible') {
                await requestWakeLock();
            }
        });

        function togglePlay() {
            isPlaying = !isPlaying;
            if (isPlaying) {
                document.getElementById('playIcon').textContent = '‚è∏';
                document.getElementById('playText').textContent = translations[currentLang].pause;
                lastTimestamp = performance.now();
                requestAnimationFrame(scroll);
                requestWakeLock();
            } else {
                document.getElementById('playIcon').textContent = '‚ñ∂';
                document.getElementById('playText').textContent = translations[currentLang].play;
                releaseWakeLock();
            }
        }

        function scroll(timestamp) {
            if (!isPlaying) return;
            
            if (lastTimestamp) {
                const delta = timestamp - lastTimestamp;
                prompter.scrollTop += (scrollSpeed * delta) / 16;
            }
            lastTimestamp = timestamp;
            
            requestAnimationFrame(scroll);
        }

        function resetScroll() {
            isPlaying = false;
            prompter.scrollTop = 0;
            document.getElementById('playIcon').textContent = '‚ñ∂';
            document.getElementById('playText').textContent = translations[currentLang].play;
            releaseWakeLock();
        }

        function updateSpeed(value) {
            scrollSpeed = parseFloat(value);
            document.getElementById('speedValue').textContent = value;
        }

        function updateFontSize(value) {
            fontSize = parseInt(value);
            scrollText.style.fontSize = fontSize + 'px';
            document.getElementById('sizeValue').textContent = value + 'px';
        }

        function toggleMirror() {
            isMirrored = !isMirrored;
            scrollText.style.transform = isMirrored ? 'scaleX(-1)' : 'scaleX(1)';
            document.getElementById('mirrorBtn').style.backgroundColor = isMirrored ? '#3f3f46' : '';
        }

        function toggleEdit() {
            const currentText = scrollText.innerHTML;
            const plainText = currentText.replace(/<p class="mb-12"[^>]*>/g, '').replace(/<\/p>/g, '\n\n').trim();
            textEditor.value = plainText;
            editModal.classList.remove('hidden');
        }

        function cancelEdit() {
            editModal.classList.add('hidden');
        }

        function saveText() {
            const text = textEditor.value;
            const paragraphs = text.split('\n').filter(p => p.trim() !== '');
            scrollText.innerHTML = paragraphs.map(p => `<p class="mb-12">${p.trim()}</p>`).join('');
            editModal.classList.add('hidden');
            resetScroll();
        }

        function toggleControls() {
            if (controls.style.display === 'none') {
                controls.style.display = 'block';
                showControlsBtn.classList.add('hidden');
            } else {
                controls.style.display = 'none';
                showControlsBtn.classList.remove('hidden');
            }
        }

        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().catch(err => {
                    console.log('Erro ao entrar em fullscreen:', err);
                });
            } else {
                document.exitFullscreen();
            }
        }

        document.addEventListener('fullscreenchange', () => {
            const fullscreenBtn = document.querySelector('#fullscreenBtn span[data-key="fullscreen"]');
            if (document.fullscreenElement) {
                fullscreenBtn.textContent = translations[currentLang].exitFullscreen;
            } else {
                fullscreenBtn.textContent = translations[currentLang].fullscreen;
            }
        });

        document.addEventListener('keydown', (e) => {
            if (editModal.classList.contains('hidden')) {
                if (e.code === 'Space') {
                    e.preventDefault();
                    togglePlay();
                } else if (e.code === 'ArrowUp') {
                    e.preventDefault();
                    const newSpeed = Math.min(8, scrollSpeed + 0.5);
                    updateSpeed(newSpeed);
                    document.getElementById('speed').value = newSpeed;
                } else if (e.code === 'ArrowDown') {
                    e.preventDefault();
                    const newSpeed = Math.max(0.5, scrollSpeed - 0.5);
                    updateSpeed(newSpeed);
                    document.getElementById('speed').value = newSpeed;
                } else if (e.code === 'KeyH') {
                    e.preventDefault();
                    toggleControls();
                } else if (e.code === 'KeyF') {
                    e.preventDefault();
                    toggleFullscreen();
                }
            }
        });
    </script>
</body>
</html>
